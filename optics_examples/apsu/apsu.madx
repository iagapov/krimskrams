
D11 : DRIFT, l=2.908094200746698;
D12 : DRIFT, l=0.4050838254873592;
D13 : DRIFT, l=0.05014404837641349;

S02A_P0 : MARKER;
S02B_P0 : MARKER;
S02A_Q1 : QUADRUPOLE, l=0.25,k1=3.311988223666687;
S02B_Q1 : QUADRUPOLE, l=0.25,k1=3.311988223666687;
S02A_Q2 : QUADRUPOLE, l=0.225,k1=-2.806503327862326;
S02B_Q2 : QUADRUPOLE, l=0.225,k1=-2.806503327862326;
S02A_Q3 : QUADRUPOLE, l=0.225,k1=-2.289738957179781;
S02B_Q3 : QUADRUPOLE, l=0.225,k1=-2.289738957179781;
S02A_Q4 : SBEND, l=0.244,angle=-0.001706915788384977,k1=3.44665225417214,e1=-0.0008534578941924886,e2=-0.0008534578941924886;
S02B_Q4 : SBEND, l=0.244,angle=-0.001706915788384977,k1=3.44665225417214,e1=-0.0008534578941924886,e2=-0.0008534578941924886;

S02A_Q5 : SBEND, l=0.15,angle=-0.001157494675584733,k1=1.578426896828277,e1=-0.0005787473377923666,e2=-0.0005787473377923666;
S02B_Q5 : SBEND, l=0.15,angle=-0.001157494675584733,k1=1.578426896828277,e1=-0.0005787473377923666,e2=-0.0005787473377923666;


S02A_Q6 : QUADRUPOLE, l=0.225,k1=-2.463268052877983;
S02B_Q6 : QUADRUPOLE, l=0.225,k1=-2.463268052877983;

S02A_Q7 : QUADRUPOLE, l=0.424,k1=3.720956199980586;
S02B_Q7 : QUADRUPOLE, l=0.424,k1=3.720956199980586;




IDAP : MARKER;
AP : MARKER;
PAAP1 : MARKER;
S02A_P1 : MARKER;


S02A_F8P1 : MARKER;


S02G1 : LINE = (D11,S02A_P0,IDAP,AP,S02A_Q1,PAAP1,S02A_P1,D12,S02A_F8P1,S02A_Q2,D13);


PABP1 : MARKER;
S02B_F8P1 : MARKER;
S02B_P1 : MARKER;

S02G9R : LINE =(D11,S02B_P0,IDAP,AP,S02B_Q1,S02B_P1,PABP1,D12,S02B_F8P1,S02B_Q2,D13);
S02G9 : LINE = (-S02G9R);



MEA : MARKER;
MEAQ : MARKER;


S02A_M1_1 : SBEND, l=0.1918442167511646,angle=0.006231803373120651,e1=0.01428579517461679,e2=-0.008053991801496133;
S02A_M1_2 : SBEND, l=0.2329808449846517,angle=0.004652921987100712,e1=0.008053991801496133,e2=-0.003401069814395421;
S02A_M1_3 : SBEND, l=0.4931459233303774,angle=0.00665360325628307,e1=0.003401069814395421,e2=0.003252533441887649;
S02A_M1_4 : SBEND, l=0.6710407783161596,angle=0.006543582722312399,e1=-0.003252533441887649,e2=0.009796116164200048;
S02A_M1_5 : SBEND, l=0.6358861013789447,angle=0.004489679010416737,e1=-0.009796116164200048,e2=0.01428579517461679;

S02B_M1_1 : SBEND, l=0.1918442167511646,angle=0.006231803373120651,e1=0.01428579517461679,e2=-0.008053991801496133;
S02B_M1_2 : SBEND, l=0.2329808449846517,angle=0.004652921987100712,e1=0.008053991801496133,e2=-0.003401069814395421;
S02B_M1_3 : SBEND, l=0.4931459233303774,angle=0.00665360325628307,e1=0.003401069814395421,e2=0.003252533441887649;
S02B_M1_4 : SBEND, l=0.6710407783161596,angle=0.006543582722312399,e1=-0.003252533441887649,e2=0.009796116164200048;
S02B_M1_5 : SBEND, l=0.6358861013789447,angle=0.004489679010416737,e1=-0.009796116164200048,e2=0.01428579517461679;

S02A_M2_1 : SBEND, l=0.2918558259213946,angle=0.002351573364742646,e1=0.01164721598470094,e2=-0.009295642619958291;
S02A_M2_2 : SBEND, l=0.3585886481950252,angle=0.003259700715380325,e1=0.009295642619958291,e2=-0.006035941904577966;
S02A_M2_3 : SBEND, l=0.486869605945606,angle=0.005176222536330231,e1=0.006035941904577966,e2=-0.0008597193682477354;
S02A_M2_4 : SBEND, l=0.3076438971768664,angle=0.003868138226183781,e1=0.0008597193682477354,e2=0.003008418857936046;
S02A_M2_5 : SBEND, l=0.5397184855320805,angle=0.008638797126764892,e1=-0.003008418857936046,e2=0.01164721598470094;

S02B_M2_1 : SBEND, l=0.2918558259213946,angle=0.002351573364742646,e1=0.01164721598470094,e2=-0.009295642619958291;
S02B_M2_2 : SBEND, l=0.3585886481950252,angle=0.003259700715380325,e1=0.009295642619958291,e2=-0.006035941904577966;
S02B_M2_3 : SBEND, l=0.486869605945606,angle=0.005176222536330231,e1=0.006035941904577966,e2=-0.0008597193682477354;
S02B_M2_4 : SBEND, l=0.3076438971768664,angle=0.003868138226183781,e1=0.0008597193682477354,e2=0.003008418857936046;
S02B_M2_5 : SBEND, l=0.5397184855320805,angle=0.008638797126764892,e1=-0.003008418857936046,e2=0.01164721598470094;


S02A_M3_1 : SBEND, l=0.41,angle=0.0125396570573382,k1=-2.102081026538629,e1=0.0125396570573382;
S02A_M3_2 : SBEND, l=0.41,angle=0.0125396570573382,k1=-2.102081026538629,e2=0.0125396570573382;

S02B_M3_1 : SBEND, l=0.41,angle=0.0125396570573382,k1=-2.102081026538629,e1=0.0125396570573382;
S02B_M3_2 : SBEND, l=0.41,angle=0.0125396570573382,k1=-2.102081026538629,e2=0.0125396570573382;



S02A_M1 : LINE = (S02A_M1_1,S02A_M1_2,S02A_M1_3,S02A_M1_4,S02A_M1_5);
S02B_M1 : LINE  = (S02B_M1_5,S02B_M1_4,S02B_M1_3,S02B_M1_2,S02B_M1_1);

S02A_M2 : LINE  = (S02A_M2_1,S02A_M2_2,S02A_M2_3,S02A_M2_4,S02A_M2_5);
S02B_M2 : LINE  = (S02B_M2_5,S02B_M2_4,S02B_M2_3,S02B_M2_2,S02B_M2_1);

S02A_M3 : LINE  = (S02A_M3_1,S02A_M3_2);
S02B_M3 : LINE  = (S02B_M3_1,S02B_M3_2);




S02G2 : LINE =(MEA,MEAQ,S02A_M1,MEA);
S02G8R : LINE =(MEA,MEAQ,S02B_M1,MEA);

S02G8 : LINE = (-S02G8R);


D21A : DRIFT, l=0.1261130139900061;
D21B : DRIFT, l=0.1186762596753099;
D24 : DRIFT, l=0.274356565603497;
D25 : DRIFT, l=0.1100000007807403;
D26 : DRIFT, l=0.1406971943591799;
D27 : DRIFT, l=0.3249533473724555;
D28 : DRIFT, l=0.1481070804106769;
D29 : DRIFT, l=0.05001490735387127;

D51: DRIFT, l=0.05000239994950361;
D52: DRIFT, l=0.2157226954362602;
D53: DRIFT, l=0.115030162986725;
D54: DRIFT, l=0.2706450913189496;


D55A: DRIFT, l=0.06032254565947483;
D55B : DRIFT, l=0.06032254565947483;
WIGH : DRIFT, l=0.075;
WIGM : MARKER;
WIGBL : LINE  =(D55A,WIGH,WIGM,WIGH,D55B);



S02A_P2 : MARKER;
S02B_P2 : MARKER;

S02A_S1L : SEXTUPOLE, l=0.1147718431634487,k2=-145.4210458921619;
S02B_S1L : SEXTUPOLE, l=0.1147718431634487,k2=-136.6968898921619;

S02A_S2L : SEXTUPOLE, l=0.1298984164119772,k2=132.8776653978636;
S02B_S2L : SEXTUPOLE, l=0.1298984164119772,k2=140.0338894978636;

S02A_S3L : SEXTUPOLE, l=0.1147718431634487,k2=-115.2625136921619;
S02B_S3L : SEXTUPOLE, l=0.1147718431634487,k2=-126.2773908921619;


S02A_P3 : MARKER;
S02A_P4 : MARKER;
S02A_F8P2 : MARKER;
S02B_P3 : MARKER;
S02B_P4 : MARKER;
S02B_F8P2 : MARKER;


PAAP4 : MARKER;
PAAP3 : MARKER;
PABP2 : MARKER;
PABP3 : MARKER;
PABP4 : MARKER;

dins : DRIFT, l=0.41;

S02G3 : LINE  = (D21A,S02A_Q3, D21B,S02A_P2,S02A_S1L,D24,S02A_Q4,PAAP3,S02A_P3,D25,S02A_S2L, D26,
        S02A_Q5, D27,S02A_F8P2,S02A_S3L,PAAP4, S02A_P4,D28, dins  ,S02A_Q6,D29);




S02G7R : LINE = (D21A,S02B_Q3,D21B,S02B_P2,PABP2,S02B_S1L,D24,S02B_Q4,
    S02B_P3,PABP3,D25,S02B_S2L,D26,S02B_Q5,D27,S02B_F8P2,S02B_S3L,
    S02B_P4,PABP4,D28,dins, S02B_Q6,D29);


S02G7 : LINE = (-S02G7R);

S02G4 :LINE = (MEA,S02A_M2,MEA);


S02G6R:  LINE = (MEA,S02B_M2,MEA);
S02G6 : LINE = (-S02G6R);

S02A_Q8 : SBEND, l=0.646,angle=-0.005358586672065405,k1=3.681034532090332,e1=-0.002679293336032703,e2=-0.002679293336032703;
S02B_Q8 : SBEND, l=0.646,angle=-0.005358586672065405,k1=3.681034532090332,e1=-0.002679293336032703,e2=-0.002679293336032703;


S02A_M4_1 : SBEND, l=0.35, angle=0.009817477042468103,k1=-2.190470816373653,e1=0.009817477042468103;
S02A_M4_2 : SBEND, l=0.35, angle=0.009817477042468103,k1=-2.190470816373653,e2=0.009817477042468103;

S02A_M4 : LINE = (S02A_M4_1, S02A_M4_2);



S02G5 : LINE =  (D51,S02A_Q7,D52,S02A_M3,D53,S02A_Q8, D54,S02A_M4,WIGBL,S02B_Q8,D53,S02B_M3,D52, S02B_Q7,D51);


S02 :LINE =(S02G1,S02G2,S02G3,S02G4,S02G5,S02G6,S02G7,S02G8,S02G9);


beam, particle=electron,energy=6.0, radiate=true;
use, period=S02;
twiss, chrom;

! natural hor. emittance in nm rad
value, table(summ, synch_5);
emit_x = (beam->gamma)^2 * 3.83e-4 * table(summ, synch_5) / ( table(summ, synch_2) - table(summ, synch_4) ) ;
value, emit_x;


plot, haxis=s, vaxis1=betx, bety, vmin=0., vaxis2 = Dx, colour=100, interpolate=true;
